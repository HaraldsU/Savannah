@page
@using Newtonsoft.Json;
@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery Antiforgery
@model IndexModel
@{
    ViewData["Title"] = "Home page";
    var requestToken = Antiforgery.GetAndStoreTokens(PageContext.HttpContext).RequestToken;
}
<input id="RequestVerificationToken" type="hidden" value="@requestToken" />
<div class="container text-center"">
    <div class="row justify-content-md-center" style="margin-left: 18%; margin-top: 2.5%;">
        <div id="heading" style="margin-right: 24%;">
            <h1 class="display-4">Welcome to the Savanna!</h1>
            <hr class="my-4">
            <p>Click on the buttons below to add animals to the grid.</p>
        </div>
        <div id="buttons" class="col col-2" style="margin-top: 5%;">
            @foreach (var animal in Model.Animals)
            {
                <div>
                    <button class="btn btn-primary text-black row mt-3" onclick="addAnimal(this.getAttribute('value'))" value="@animal.Name">Add @animal.Name</button>
                </div>
            }
        </div>
        <div id="grid" class="col col-sm-10 col-md-10 col-lg-10 col-xl-10 bd-example-row">
            <div class="container text-center gridDivs" style="margin-top: 8%;">
                @{
                    int colId = 0;
                }
                @for (int i = 0; i < MathF.Sqrt(IndexModel.Grid.Grid.Count); i++)
                {
                    <div class="row">
                        @for (int j = 0; j < MathF.Sqrt(IndexModel.Grid.Grid.Count); j++)
                        {
                            var animal = IndexModel.Grid.Grid[i * (int)MathF.Sqrt(IndexModel.Grid.Grid.Count) + j].Animal;
                            char gridText = '\u00AD';
                            @if (animal != null)
                            {
                                if (animal.Prey != null)
                                {
                                    gridText = animal.Prey.FirstLetter;
                                }
                                else if (animal.Predator != null)
                                {
                                    gridText = animal.Predator.FirstLetter;
                                }
                            }
                            <div id="col @colId" class="col box bg-secondary border d-flex justify-content-center">
                                <span id="gridCells" style="margin-top: 50%;">@gridText</span>
                            </div>
                            colId++;
                        }
                    </div>
                }
            </div>
        </div>
    </div>
</div>